"""310. Minimum Height Trees
https://leetcode.com/problems/minimum-height-trees/
"""
import collections
from typing import List


class Solution:
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
        def dfs(x: int, y: int, visited) -> int:
            if y in graph[x]:
                return 1
            k1 = '{0}-{1}'.format(x, y)
            k2 = '{0}-{1}'.format(y, x)
            if k1 in memo:
                return memo[k1]
            if k2 in memo:
                return memo[k2]
            visited.add(x)
            distance = n
            for next_node in graph[x]:
                if next_node not in visited:
                    distance = min(1 + dfs(next_node, y, visited), distance)
            visited.remove(x)
            if distance < n:
                memo[k1] = distance
            return distance

        graph = collections.defaultdict(set)
        for a, b in edges:
            graph[a].add(b)
            graph[b].add(a)
        min_height = n
        roots = []
        memo = dict()
        for i in range(n):
            h = 0
            for j in range(n):
                if i != j:
                    h = max(h, dfs(i, j, set()))
            if h < min_height:
                min_height = h
                roots = [i]
            elif h == min_height:
                roots.append(i)
        return roots


if __name__ == '__main__':
    sol = Solution()
    print(sol.findMinHeightTrees(606
,[[0,1],[0,2],[1,3],[3,4],[0,5],[3,6],[2,7],[2,8],[5,9],[0,10],[3,11],[3,12],[3,13],[7,14],[4,15],[8,16],[3,17],[10,18],[0,19],[19,20],[18,21],[12,22],[11,23],[0,24],[16,25],[5,26],[21,27],[2,28],[16,29],[7,30],[14,31],[21,32],[16,33],[5,34],[3,35],[32,36],[6,37],[5,38],[9,39],[12,40],[13,41],[29,42],[22,43],[26,44],[22,45],[1,46],[43,47],[38,48],[20,49],[12,50],[36,51],[16,52],[24,53],[45,54],[27,55],[20,56],[39,57],[49,58],[33,59],[43,60],[46,61],[7,62],[55,63],[35,64],[42,65],[5,66],[29,67],[66,68],[19,69],[60,70],[43,71],[36,72],[37,73],[56,74],[73,75],[19,76],[3,77],[41,78],[12,79],[24,80],[50,81],[76,82],[71,83],[13,84],[20,85],[59,86],[80,87],[37,88],[64,89],[2,90],[81,91],[20,92],[55,93],[0,94],[27,95],[29,96],[50,97],[76,98],[80,99],[22,100],[12,101],[91,102],[90,103],[43,104],[79,105],[20,106],[13,107],[58,108],[16,109],[103,110],[4,111],[87,112],[84,113],[51,114],[111,115],[96,116],[1,117],[73,118],[61,119],[24,120],[50,121],[16,122],[52,123],[54,124],[84,125],[2,126],[120,127],[109,128],[2,129],[6,130],[130,131],[2,132],[47,133],[60,134],[112,135],[118,136],[76,137],[70,138],[84,139],[135,140],[55,141],[87,142],[9,143],[6,144],[78,145],[110,146],[113,147],[2,148],[55,149],[103,150],[16,151],[0,152],[141,153],[89,154],[141,155],[31,156],[26,157],[46,158],[49,159],[111,160],[150,161],[40,162],[133,163],[67,164],[77,165],[59,166],[81,167],[104,168],[53,169],[96,170],[169,171],[49,172],[26,173],[110,174],[73,175],[41,176],[77,177],[40,178],[109,179],[120,180],[49,181],[83,182],[19,183],[25,184],[25,185],[73,186],[8,187],[4,188],[56,189],[178,190],[51,191],[28,192],[43,193],[19,194],[108,195],[106,196],[75,197],[126,198],[10,199],[94,200],[81,201],[113,202],[151,203],[186,204],[145,205],[110,206],[27,207],[21,208],[161,209],[131,210],[17,211],[76,212],[130,213],[44,214],[127,215],[48,216],[190,217],[8,218],[69,219],[189,220],[177,221],[148,222],[158,223],[124,224],[27,225],[205,226],[28,227],[65,228],[111,229],[189,230],[143,231],[27,232],[160,233],[226,234],[7,235],[52,236],[93,237],[103,238],[107,239],[189,240],[56,241],[43,242],[81,243],[127,244],[127,245],[22,246],[246,247],[233,248],[68,249],[89,250],[66,251],[138,252],[49,253],[246,254],[141,255],[23,256],[34,257],[197,258],[114,259],[249,260],[71,261],[199,262],[34,263],[92,264],[198,265],[241,266],[148,267],[161,268],[55,269],[122,270],[25,271],[5,272],[4,273],[27,274],[209,275],[193,276],[51,277],[111,278],[54,279],[278,280],[49,281],[92,282],[107,283],[135,284],[134,285],[225,286],[138,287],[98,288],[35,289],[280,290],[29,291],[174,292],[83,293],[16,294],[52,295],[116,296],[213,297],[255,298],[23,299],[143,300],[108,301],[285,302],[150,303],[82,304],[44,305],[224,306],[265,307],[6,308],[157,309],[149,310],[125,311],[262,312],[38,313],[169,314],[240,315],[151,316],[50,317],[114,318],[237,319],[208,320],[160,321],[130,322],[190,323],[315,324],[179,325],[33,326],[34,327],[239,328],[58,329],[193,330],[192,331],[219,332],[11,333],[150,334],[84,335],[103,336],[187,337],[67,338],[238,339],[49,340],[288,341],[264,342],[43,343],[34,344],[226,345],[23,346],[90,347],[12,348],[273,349],[236,350],[192,351],[321,352],[33,353],[74,354],[203,355],[90,356],[205,357],[244,358],[318,359],[194,360],[202,361],[180,362],[358,363],[9,364],[178,365],[318,366],[171,367],[137,368],[101,369],[369,370],[110,371],[328,372],[186,373],[35,374],[33,375],[296,376],[57,377],[277,378],[190,379],[332,380],[180,381],[215,382],[174,383],[9,384],[159,385],[275,386],[96,387],[198,388],[387,389],[257,390],[361,391],[16,392],[246,393],[306,394],[175,395],[29,396],[377,397],[271,398],[2,399],[235,400],[336,401],[112,402],[221,403],[278,404],[82,405],[263,406],[401,407],[227,408],[1,409],[116,410],[139,411],[1,412],[103,413],[304,414],[240,415],[411,416],[412,417],[408,418],[361,419],[170,420],[65,421],[165,422],[212,423],[53,424],[184,425],[370,426],[289,427],[299,428],[141,429],[237,430],[205,431],[2,432],[239,433],[173,434],[358,435],[174,436],[323,437],[130,438],[1,439],[176,440],[169,441],[256,442],[146,443],[109,444],[284,445],[130,446],[430,447],[43,448],[159,449],[193,450],[138,451],[136,452],[248,453],[60,454],[213,455],[54,456],[239,457],[315,458],[396,459],[179,460],[413,461],[413,462],[456,463],[273,464],[26,465],[89,466],[393,467],[249,468],[397,469],[86,470],[316,471],[138,472],[152,473],[377,474],[376,475],[113,476],[426,477],[413,478],[303,479],[13,480],[470,481],[82,482],[116,483],[110,484],[211,485],[96,486],[316,487],[407,488],[113,489],[385,490],[327,491],[280,492],[109,493],[177,494],[79,495],[332,496],[485,497],[270,498],[184,499],[104,500],[12,501],[187,502],[166,503],[374,504],[56,505],[333,506],[169,507],[134,508],[79,509],[453,510],[256,511],[198,512],[389,513],[125,514],[219,515],[181,516],[254,517],[163,518],[13,519],[290,520],[39,521],[87,522],[136,523],[124,524],[121,525],[277,526],[418,527],[120,528],[33,529],[67,530],[28,531],[337,532],[177,533],[381,534],[38,535],[343,536],[348,537],[9,538],[533,539],[342,540],[343,541],[141,542],[11,543],[538,544],[200,545],[47,546],[439,547],[201,548],[526,549],[479,550],[79,551],[85,552],[141,553],[58,554],[413,555],[437,556],[32,557],[310,558],[258,559],[248,560],[40,561],[331,562],[439,563],[209,564],[108,565],[493,566],[95,567],[377,568],[114,569],[199,570],[97,571],[418,572],[345,573],[573,574],[395,575],[492,576],[524,577],[232,578],[499,579],[290,580],[232,581],[315,582],[437,583],[364,584],[240,585],[175,586],[297,587],[473,588],[164,589],[472,590],[461,591],[32,592],[480,593],[212,594],[208,595],[176,596],[553,597],[19,598],[0,599],[185,600],[438,601],[244,602],[516,603],[469,604],[171,605]]))
